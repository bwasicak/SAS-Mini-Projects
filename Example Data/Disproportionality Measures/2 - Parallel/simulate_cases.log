1                                       The SAS System               16:29 Tuesday, May 1, 2018

NOTE: Copyright (c) 2016 by SAS Institute Inc., Cary, NC, USA. 
NOTE: SAS (r) Proprietary Software 9.4 (TS1M5) 
      Licensed to SAS INTERNAL 940 17W43 WX6+ FULL PROD+GRID RESTRIC, Site 70146502.
NOTE: This session is executing on the X64_10PRO  platform.



NOTE: Updated analytical products:
      
      SAS/STAT 14.3
      SAS/ETS 14.3
      SAS/OR 14.3
      SAS/IML 14.3
      SAS/QC 14.3

NOTE: Additional host information:

 X64_10PRO WIN 10.0.16299  Workstation

NOTE: SAS initialization used:
      real time           0.21 seconds
      cpu time            0.12 seconds
      
1          /*
2          
3          	This is a parallel execution version of the simulate_cases.sas code used in the
3        ! disproportionality measures project
4          
5          	this file contains the code, including local macros, to create simulated datasets
5        ! with 10,000 cases under four scenarios:
6          			1 - single product and single event
7          			2 - single product and multiple events
8          			3 - multiple products and single event
9          			4 - multiple products and multiple events
10         
11         	these are the datasets that get created in library sim:
12         		EX1.sas7bdat - independent pairs of product/event
13         				each row is product/event pair where rows are considered independent
14         		EX2_LONG.sas7bdat - cases with a single product and multiple events
15         				each row is a product/event pair and multiple rows for multiple events are
15       ! grouped by a case
16         		EX2_WIDE.sas7bdat - cases with a single product and multiple events
17         				each row is a case with product and a column containing a delimited list of
17       ! associated events
18         		EX3_LONG.sas7bdat - cases with multiple products and a single event
19         		 		each row is a product/event pair and multiple rows for multiple products are
19       ! grouped by a case
20         		EX3_WIDE.sas7bdat - cases with multiple products and a single event
21         		 		each row is a case with event and a column containing a delimited list of
21       ! associated products
22         		EX4_LONG.sas7bdat - cases with multiple products and multiple events
2                                       The SAS System               16:29 Tuesday, May 1, 2018

23         				each row is a product/event pair and multiple rows for multiple products and
23       ! events are grouped by a case
24         		EX4_WIDE.sas7bdat - cases with multiple products and multiple events
25         				each row is a case with columns containing a delimited list of products and a
25       ! delimited list of events
26         
27         	This is an input file with known distributions for a set of drugs and events
28         		drug_event_example.sas7bdat
29         
30         	The simulated cases do the following:
31         
32         
33         */
34         
35         /* specify output location for the ouput files (sim_out) and the expected input file
35       !  drug_event_example.sas7bdat (sim_in) */
36         		libname sim_in '../../../Disproportionality Measures/simulating cases';
NOTE: Libref SIM_IN was successfully assigned as follows: 
      Engine:        V9 
      Physical Name: C:\PROJECTS\SAS-Mini-Projects\Disproportionality Measures\simulating cases
37         		libname sim_out './examples';
NOTE: Libref SIM_OUT was successfully assigned as follows: 
      Engine:        V9 
      Physical Name: C:\PROJECTS\SAS-Mini-Projects\Parallelism\Examples\Disproportionality 
      Measures\examples
38         
39         %macro run_batches(NSessions,Ncases,SEED=-1);
40         	OPTIONS SASCMD='!sascmd';
41         
42         	%DO SESS = 1 %TO &NSessions.;
43         		SIGNON SESS&SESS. CONNECTWAIT=NO;
44         		%SYSLPUT Ncases=&Ncases.;
45         		%SYSLPUT NSessions=&NSessions.;
46         		%SYSLPUT SEED=&SEED.;
47         		%SYSLPUT SESS=&SESS.;
48         		RSUBMIT SESS&SESS. CONNECTPERSIST=NO INHERITLIB=(work=remote);
49         
50         							/* include the macros for building simulated cases (%basecase) and adding
50       ! drugs (%add_drugs) and events (%add_events) */
51         									%include '../../../Disproportionality Measures/simulating
51       ! cases/Macros/basecase.sas';
52         									%include '../../../Disproportionality Measures/simulating
52       ! cases/Macros/add_events.sas';
53         									%include '../../../Disproportionality Measures/simulating
53       ! cases/Macros/add_drugs.sas';
54         
55         							/* specify output location for the ouput files (sim_out) and the expected
55       ! input file drug_event_example.sas7bdat (sim_in) */
56         									libname sim_in '../../../Disproportionality Measures/simulating cases';
57         									libname sim_out './examples';
58         
3                                       The SAS System               16:29 Tuesday, May 1, 2018

59         							/* create information tables: drug_event, drugs, events */
60         									Proc sql;
61         									/* add percentage to events within drugs - the DE_percent will represent
61       ! the % of reports for that Drug that are the specific event */
62         										create table drug_event as
63         											select a.DrugName, a.EventName, a.Nij as DE_COUNT, b.D_COUNT,
63       ! a.Nij/b.D_COUNT as DE_PERCENT, a.Nij/c.E_Count as ED_PERCENT, C.E_COUNT, a.TOTAL
64         											from
65         												(select DrugName, EventName, Nij, sum(Nij) as TOTAL from
65       ! sim_in.drug_event_example) a
66         												left outer join
67         												(select DrugName, sum(Nij) as D_COUNT from sim_in.drug_event_example
67       ! group by DrugName) b
68         												on a.DrugName=b.DrugName
69         												left outer join
70         												(select EventName, sum(Nij) as E_COUNT from sim_in.drug_event_example
70       ! group by EventName) c
71         												on a.EventName=c.EventName
72         											order by a.DrugName, a.EventName
73         										;
74         									/* Drugs table with column D_PERCENT = proportion of reports that are for
74       ! the specific drug */
75         										create table drugs as
76         											select distinct DrugName, D_COUNT, TOTAL, D_COUNT/TOTAL as D_PERCENT
77         											from drug_event
78         										;
79         									/* Evemts table with column E_PERCENT = proportion of reports that are for
79       ! the specific event */
80         										create table events as
81         											select distinct EventName, E_COUNT, TOTAL, E_COUNT/TOTAL as E_PERCENT
82         											from drug_event
83         										;
84         									quit;
85         
86         			options nosource nonotes;
87         				%basecase(core,&NCases.,1,SEED=&SEED.);
88         					%add_events(core,remote.EX1_&SESS.,1);
89         					%add_events(core,remote.EX2_LONG_&SESS.,-1);
90         					%add_drugs(remote.EX1_&SESS.,remote.EX3_LONG_&SESS.,-1);
91         					%add_drugs(remote.EX2_LONG_&SESS.,remote.EX4_LONG_&SESS.,-1);
92         			options source notes;
93         
94         		ENDRSUBMIT;
95         	%END;
96         
97         	WAITFOR _ALL_ %DO SESS = 1 %TO &NSessions.; SESS&SESS. %END;;
98         
99         	%DO SESS = 1 %TO &NSessions.;
100        		%IF &SESS. =1 %THEN %DO;
101        			Data EX1; set EX1_&SESS.; run;
102        			Data EX2_LONG; set EX2_LONG_&SESS.; run;
4                                       The SAS System               16:29 Tuesday, May 1, 2018

103        			Data EX3_LONG; set EX3_LONG_&SESS.; run;
104        			Data EX4_LONG; set EX4_LONG_&SESS.; run;
105        		%END;
106        		%ELSE %DO;
107        			Data EX1_&SESS.; set EX1_&SESS.; Case_N=Case_N+&NCases.*(&SESS.-1); run;
108        			Data EX2_LONG_&SESS.; set EX2_LONG_&SESS.; Case_N=Case_N+&NCases.*(&SESS.-1); run
108      ! ;
109        			Data EX3_LONG_&SESS.; set EX3_LONG_&SESS.; Case_N=Case_N+&NCases.*(&SESS.-1); run
109      ! ;
110        			Data EX4_LONG_&SESS.; set EX4_LONG_&SESS.; Case_N=Case_N+&NCases.*(&SESS.-1); run
110      ! ;
111        			Proc append base=EX1 data=EX1_&SESS.; run;
112        			Proc append base=EX2_LONG data=EX2_LONG_&SESS.; run;
113        			Proc append base=EX3_LONG data=EX3_LONG_&SESS.; run;
114        			Proc append base=EX4_LONG data=EX4_LONG_&SESS.; run;
115        		%END;
116        	%END;
117        
118        %mend run_batches;
119        %run_batches(5,50000);
NOTE: Remote signon to SESS1 commencing (SAS Release 9.04.01M5P091317).
NOTE: Unable to open SASUSER.PROFILE. WORK.PROFILE will be opened instead.
NOTE: All profile changes will be lost at the end of the session.
NOTE: Copyright (c) 2016 by SAS Institute Inc., Cary, NC, USA. 
NOTE: SAS (r) Proprietary Software 9.4 (TS1M5) 
      Licensed to SAS INTERNAL 940 17W43 WX6+ FULL PROD+GRID RESTRIC, Site 70146502.
NOTE: This session is executing on the X64_10PRO  platform.



NOTE: Updated analytical products:
      
      SAS/STAT 14.3
      SAS/ETS 14.3
      SAS/OR 14.3
      SAS/IML 14.3
      SAS/QC 14.3

NOTE: Additional host information:

 X64_10PRO WIN 10.0.16299  Workstation

NOTE: SAS initialization used:
      real time           0.24 seconds
      cpu time            0.23 seconds
      
NOTE: Remote signon to SESS1 complete.
5                                       The SAS System               16:29 Tuesday, May 1, 2018

NOTE: Background remote submit to SESS1 in progress.
NOTE: Remote signon to SESS2 commencing (SAS Release 9.04.01M5P091317).
NOTE: Unable to open SASUSER.PROFILE. WORK.PROFILE will be opened instead.
NOTE: All profile changes will be lost at the end of the session.
NOTE: Copyright (c) 2016 by SAS Institute Inc., Cary, NC, USA. 
NOTE: SAS (r) Proprietary Software 9.4 (TS1M5) 
      Licensed to SAS INTERNAL 940 17W43 WX6+ FULL PROD+GRID RESTRIC, Site 70146502.
NOTE: This session is executing on the X64_10PRO  platform.



NOTE: Updated analytical products:
      
      SAS/STAT 14.3
      SAS/ETS 14.3
      SAS/OR 14.3
      SAS/IML 14.3
      SAS/QC 14.3

NOTE: Additional host information:

 X64_10PRO WIN 10.0.16299  Workstation

NOTE: SAS initialization used:
      real time           0.25 seconds
      cpu time            0.23 seconds
      
NOTE: Remote signon to SESS2 complete.
5                                       The SAS System               16:29 Tuesday, May 1, 2018

NOTE: Background remote submit to SESS2 in progress.
NOTE: Remote signon to SESS3 commencing (SAS Release 9.04.01M5P091317).
NOTE: Unable to open SASUSER.PROFILE. WORK.PROFILE will be opened instead.
NOTE: All profile changes will be lost at the end of the session.
NOTE: Copyright (c) 2016 by SAS Institute Inc., Cary, NC, USA. 
NOTE: SAS (r) Proprietary Software 9.4 (TS1M5) 
      Licensed to SAS INTERNAL 940 17W43 WX6+ FULL PROD+GRID RESTRIC, Site 70146502.
NOTE: This session is executing on the X64_10PRO  platform.



NOTE: Updated analytical products:
      
      SAS/STAT 14.3
      SAS/ETS 14.3
      SAS/OR 14.3
      SAS/IML 14.3
      SAS/QC 14.3

NOTE: Additional host information:

 X64_10PRO WIN 10.0.16299  Workstation

NOTE: SAS initialization used:
      real time           0.32 seconds
      cpu time            0.28 seconds
      
NOTE: Remote signon to SESS3 complete.
5                                       The SAS System               16:29 Tuesday, May 1, 2018

NOTE: Background remote submit to SESS3 in progress.
NOTE: Remote signon to SESS4 commencing (SAS Release 9.04.01M5P091317).
NOTE: Unable to open SASUSER.PROFILE. WORK.PROFILE will be opened instead.
NOTE: All profile changes will be lost at the end of the session.
NOTE: Copyright (c) 2016 by SAS Institute Inc., Cary, NC, USA. 
NOTE: SAS (r) Proprietary Software 9.4 (TS1M5) 
      Licensed to SAS INTERNAL 940 17W43 WX6+ FULL PROD+GRID RESTRIC, Site 70146502.
NOTE: This session is executing on the X64_10PRO  platform.



NOTE: Updated analytical products:
      
      SAS/STAT 14.3
      SAS/ETS 14.3
      SAS/OR 14.3
      SAS/IML 14.3
      SAS/QC 14.3

NOTE: Additional host information:

 X64_10PRO WIN 10.0.16299  Workstation

NOTE: SAS initialization used:
      real time           0.38 seconds
      cpu time            0.26 seconds
      
NOTE: Remote signon to SESS4 complete.
5                                       The SAS System               16:29 Tuesday, May 1, 2018

NOTE: Background remote submit to SESS4 in progress.
NOTE: Remote signon to SESS5 commencing (SAS Release 9.04.01M5P091317).
NOTE: Unable to open SASUSER.PROFILE. WORK.PROFILE will be opened instead.
NOTE: All profile changes will be lost at the end of the session.
NOTE: Copyright (c) 2016 by SAS Institute Inc., Cary, NC, USA. 
NOTE: SAS (r) Proprietary Software 9.4 (TS1M5) 
      Licensed to SAS INTERNAL 940 17W43 WX6+ FULL PROD+GRID RESTRIC, Site 70146502.
NOTE: This session is executing on the X64_10PRO  platform.



NOTE: Updated analytical products:
      
      SAS/STAT 14.3
      SAS/ETS 14.3
      SAS/OR 14.3
      SAS/IML 14.3
      SAS/QC 14.3

NOTE: Additional host information:

 X64_10PRO WIN 10.0.16299  Workstation

NOTE: SAS initialization used:
      real time           0.40 seconds
      cpu time            0.26 seconds
      
NOTE: Remote signon to SESS5 complete.
5                                       The SAS System               16:29 Tuesday, May 1, 2018

NOTE: Background remote submit to SESS5 in progress.
NOTE: Remote submit to SESS5 commencing.
1     %include '../../../Disproportionality Measures/simulating cases/Macros/basecase.sas';
33    %include '../../../Disproportionality Measures/simulating cases/Macros/add_events.sas';
113   %include '../../../Disproportionality Measures/simulating cases/Macros/add_drugs.sas';
194   libname sim_in '../../../Disproportionality Measures/simulating cases';
NOTE: Libref SIM_IN was successfully assigned as follows:
      Engine:        V9
      Physical Name: C:\PROJECTS\SAS-Mini-Projects\Disproportionality Measures\simulating cases
195   libname sim_out './examples';
NOTE: Libref SIM_OUT was successfully assigned as follows:
      Engine:        V9
      Physical Name: C:\PROJECTS\SAS-Mini-Projects\Parallelism\Examples\Disproportionality
      Measures\examples
196   Proc sql;
197   create table drug_event as select a.DrugName, a.EventName, a.Nij as DE_COUNT, b.D_COUNT,
197! a.Nij/b.D_COUNT as DE_PERCENT, a.Nij/c.E_Count as ED_PERCENT, C.E_COUNT, a.TOTAL from
197! (select DrugName, EventName, Nij, sum(Nij) as TOTAL from sim_in.drug_event_example) a left
197!  outer join (select DrugName, sum(Nij) as D_COUNT from sim_in.drug_event_example group by
197! DrugName) b on a.DrugName=b.DrugName left outer join (select EventName, sum(Nij) as
197! E_COUNT from sim_in.drug_event_example group by EventName) c on a.EventName=c.EventName
197! order by a.DrugName, a.EventName ;
NOTE: The query requires remerging summary statistics back with the original data.
NOTE: Table WORK.DRUG_EVENT created, with 385734 rows and 8 columns.
7                                       The SAS System               16:29 Tuesday, May 1, 2018

6                                       The SAS System               16:29 Tuesday, May 1, 2018
 
 
198   create table drugs as select distinct DrugName, D_COUNT, TOTAL, D_COUNT/TOTAL as
198! D_PERCENT from drug_event ;
NOTE: Table WORK.DRUGS created, with 1398 rows and 4 columns.
 
199   create table events as select distinct EventName, E_COUNT, TOTAL, E_COUNT/TOTAL as
199! E_PERCENT from drug_event ;
NOTE: Table WORK.EVENTS created, with 952 rows and 4 columns.
 
200   quit;
NOTE: PROCEDURE SQL used (Total process time):
      real time           1.50 seconds
      cpu time            2.34 seconds
 
 
201   options nosource nonotes;
WARNING: A table has been extended with null columns to perform the UNION set operation.
WARNING: A table has been extended with null columns to perform the UNION set operation.
NOTE: Remote submit to SESS5 complete.
NOTE: Remote signoff from SESS5 commencing.
NOTE: SAS Institute Inc., SAS Campus Drive, Cary, NC USA 27513-2414
NOTE: The SAS System used:
      real time           17:18:55.67
      cpu time            12:42:38.90
      
NOTE: Remote signoff from SESS5 complete.
NOTE: Remote submit to SESS2 commencing.
1     %include '../../../Disproportionality Measures/simulating cases/Macros/basecase.sas';
33    %include '../../../Disproportionality Measures/simulating cases/Macros/add_events.sas';
113   %include '../../../Disproportionality Measures/simulating cases/Macros/add_drugs.sas';
194   libname sim_in '../../../Disproportionality Measures/simulating cases';
NOTE: Libref SIM_IN was successfully assigned as follows:
      Engine:        V9
      Physical Name: C:\PROJECTS\SAS-Mini-Projects\Disproportionality Measures\simulating cases
195   libname sim_out './examples';
NOTE: Libref SIM_OUT was successfully assigned as follows:
      Engine:        V9
      Physical Name: C:\PROJECTS\SAS-Mini-Projects\Parallelism\Examples\Disproportionality
      Measures\examples
196   Proc sql;
197   create table drug_event as select a.DrugName, a.EventName, a.Nij as DE_COUNT, b.D_COUNT,
197! a.Nij/b.D_COUNT as DE_PERCENT, a.Nij/c.E_Count as ED_PERCENT, C.E_COUNT, a.TOTAL from
197! (select DrugName, EventName, Nij, sum(Nij) as TOTAL from sim_in.drug_event_example) a left
197!  outer join (select DrugName, sum(Nij) as D_COUNT from sim_in.drug_event_example group by
197! DrugName) b on a.DrugName=b.DrugName left outer join (select EventName, sum(Nij) as
197! E_COUNT from sim_in.drug_event_example group by EventName) c on a.EventName=c.EventName
197! order by a.DrugName, a.EventName ;
NOTE: The query requires remerging summary statistics back with the original data.
NOTE: Table WORK.DRUG_EVENT created, with 385734 rows and 8 columns.
7                                       The SAS System               16:29 Tuesday, May 1, 2018

6                                       The SAS System               16:29 Tuesday, May 1, 2018
 
 
198   create table drugs as select distinct DrugName, D_COUNT, TOTAL, D_COUNT/TOTAL as
198! D_PERCENT from drug_event ;
NOTE: Table WORK.DRUGS created, with 1398 rows and 4 columns.
 
199   create table events as select distinct EventName, E_COUNT, TOTAL, E_COUNT/TOTAL as
199! E_PERCENT from drug_event ;
NOTE: Table WORK.EVENTS created, with 952 rows and 4 columns.
 
200   quit;
NOTE: PROCEDURE SQL used (Total process time):
      real time           1.33 seconds
      cpu time            2.12 seconds
 
 
201   options nosource nonotes;
WARNING: A table has been extended with null columns to perform the UNION set operation.
WARNING: A table has been extended with null columns to perform the UNION set operation.
NOTE: Remote submit to SESS2 complete.
NOTE: Remote signoff from SESS2 commencing.
NOTE: SAS Institute Inc., SAS Campus Drive, Cary, NC USA 27513-2414
NOTE: The SAS System used:
      real time           17:19:30.79
      cpu time            12:41:57.65
      
NOTE: Remote signoff from SESS2 complete.
NOTE: Remote submit to SESS1 commencing.
1     %include '../../../Disproportionality Measures/simulating cases/Macros/basecase.sas';
33    %include '../../../Disproportionality Measures/simulating cases/Macros/add_events.sas';
113   %include '../../../Disproportionality Measures/simulating cases/Macros/add_drugs.sas';
194   libname sim_in '../../../Disproportionality Measures/simulating cases';
NOTE: Libref SIM_IN was successfully assigned as follows:
      Engine:        V9
      Physical Name: C:\PROJECTS\SAS-Mini-Projects\Disproportionality Measures\simulating cases
195   libname sim_out './examples';
NOTE: Libref SIM_OUT was successfully assigned as follows:
      Engine:        V9
      Physical Name: C:\PROJECTS\SAS-Mini-Projects\Parallelism\Examples\Disproportionality
      Measures\examples
196   Proc sql;
197   create table drug_event as select a.DrugName, a.EventName, a.Nij as DE_COUNT, b.D_COUNT,
197! a.Nij/b.D_COUNT as DE_PERCENT, a.Nij/c.E_Count as ED_PERCENT, C.E_COUNT, a.TOTAL from
197! (select DrugName, EventName, Nij, sum(Nij) as TOTAL from sim_in.drug_event_example) a left
197!  outer join (select DrugName, sum(Nij) as D_COUNT from sim_in.drug_event_example group by
197! DrugName) b on a.DrugName=b.DrugName left outer join (select EventName, sum(Nij) as
197! E_COUNT from sim_in.drug_event_example group by EventName) c on a.EventName=c.EventName
197! order by a.DrugName, a.EventName ;
NOTE: The query requires remerging summary statistics back with the original data.
NOTE: Table WORK.DRUG_EVENT created, with 385734 rows and 8 columns.
7                                       The SAS System               16:29 Tuesday, May 1, 2018

6                                       The SAS System               16:29 Tuesday, May 1, 2018
 
 
198   create table drugs as select distinct DrugName, D_COUNT, TOTAL, D_COUNT/TOTAL as
198! D_PERCENT from drug_event ;
NOTE: Table WORK.DRUGS created, with 1398 rows and 4 columns.
 
199   create table events as select distinct EventName, E_COUNT, TOTAL, E_COUNT/TOTAL as
199! E_PERCENT from drug_event ;
NOTE: Table WORK.EVENTS created, with 952 rows and 4 columns.
 
200   quit;
NOTE: PROCEDURE SQL used (Total process time):
      real time           1.04 seconds
      cpu time            1.85 seconds
 
 
201   options nosource nonotes;
WARNING: A table has been extended with null columns to perform the UNION set operation.
WARNING: A table has been extended with null columns to perform the UNION set operation.
NOTE: Remote submit to SESS1 complete.
NOTE: Remote signoff from SESS1 commencing.
NOTE: SAS Institute Inc., SAS Campus Drive, Cary, NC USA 27513-2414
NOTE: The SAS System used:
      real time           17:22:27.57
      cpu time            12:45:07.09
      
NOTE: Remote signoff from SESS1 complete.
NOTE: Remote submit to SESS4 commencing.
1     %include '../../../Disproportionality Measures/simulating cases/Macros/basecase.sas';
33    %include '../../../Disproportionality Measures/simulating cases/Macros/add_events.sas';
113   %include '../../../Disproportionality Measures/simulating cases/Macros/add_drugs.sas';
194   libname sim_in '../../../Disproportionality Measures/simulating cases';
NOTE: Libref SIM_IN was successfully assigned as follows:
      Engine:        V9
      Physical Name: C:\PROJECTS\SAS-Mini-Projects\Disproportionality Measures\simulating cases
195   libname sim_out './examples';
NOTE: Libref SIM_OUT was successfully assigned as follows:
      Engine:        V9
      Physical Name: C:\PROJECTS\SAS-Mini-Projects\Parallelism\Examples\Disproportionality
      Measures\examples
196   Proc sql;
197   create table drug_event as select a.DrugName, a.EventName, a.Nij as DE_COUNT, b.D_COUNT,
197! a.Nij/b.D_COUNT as DE_PERCENT, a.Nij/c.E_Count as ED_PERCENT, C.E_COUNT, a.TOTAL from
197! (select DrugName, EventName, Nij, sum(Nij) as TOTAL from sim_in.drug_event_example) a left
197!  outer join (select DrugName, sum(Nij) as D_COUNT from sim_in.drug_event_example group by
197! DrugName) b on a.DrugName=b.DrugName left outer join (select EventName, sum(Nij) as
197! E_COUNT from sim_in.drug_event_example group by EventName) c on a.EventName=c.EventName
197! order by a.DrugName, a.EventName ;
NOTE: The query requires remerging summary statistics back with the original data.
NOTE: Table WORK.DRUG_EVENT created, with 385734 rows and 8 columns.
7                                       The SAS System               16:29 Tuesday, May 1, 2018

6                                       The SAS System               16:29 Tuesday, May 1, 2018
 
 
198   create table drugs as select distinct DrugName, D_COUNT, TOTAL, D_COUNT/TOTAL as
198! D_PERCENT from drug_event ;
NOTE: Table WORK.DRUGS created, with 1398 rows and 4 columns.
 
199   create table events as select distinct EventName, E_COUNT, TOTAL, E_COUNT/TOTAL as
199! E_PERCENT from drug_event ;
NOTE: Table WORK.EVENTS created, with 952 rows and 4 columns.
 
200   quit;
NOTE: PROCEDURE SQL used (Total process time):
      real time           1.49 seconds
      cpu time            2.31 seconds
 
 
201   options nosource nonotes;
WARNING: A table has been extended with null columns to perform the UNION set operation.
WARNING: A table has been extended with null columns to perform the UNION set operation.
NOTE: Remote submit to SESS4 complete.
NOTE: Remote signoff from SESS4 commencing.
NOTE: SAS Institute Inc., SAS Campus Drive, Cary, NC USA 27513-2414
NOTE: The SAS System used:
      real time           17:23:23.29
      cpu time            12:45:27.84
      
NOTE: Remote signoff from SESS4 complete.
NOTE: Remote submit to SESS3 commencing.
1     %include '../../../Disproportionality Measures/simulating cases/Macros/basecase.sas';
33    %include '../../../Disproportionality Measures/simulating cases/Macros/add_events.sas';
113   %include '../../../Disproportionality Measures/simulating cases/Macros/add_drugs.sas';
194   libname sim_in '../../../Disproportionality Measures/simulating cases';
NOTE: Libref SIM_IN was successfully assigned as follows:
      Engine:        V9
      Physical Name: C:\PROJECTS\SAS-Mini-Projects\Disproportionality Measures\simulating cases
195   libname sim_out './examples';
NOTE: Libref SIM_OUT was successfully assigned as follows:
      Engine:        V9
      Physical Name: C:\PROJECTS\SAS-Mini-Projects\Parallelism\Examples\Disproportionality
      Measures\examples
196   Proc sql;
197   create table drug_event as select a.DrugName, a.EventName, a.Nij as DE_COUNT, b.D_COUNT,
197! a.Nij/b.D_COUNT as DE_PERCENT, a.Nij/c.E_Count as ED_PERCENT, C.E_COUNT, a.TOTAL from
197! (select DrugName, EventName, Nij, sum(Nij) as TOTAL from sim_in.drug_event_example) a left
197!  outer join (select DrugName, sum(Nij) as D_COUNT from sim_in.drug_event_example group by
197! DrugName) b on a.DrugName=b.DrugName left outer join (select EventName, sum(Nij) as
197! E_COUNT from sim_in.drug_event_example group by EventName) c on a.EventName=c.EventName
197! order by a.DrugName, a.EventName ;
NOTE: The query requires remerging summary statistics back with the original data.
NOTE: Table WORK.DRUG_EVENT created, with 385734 rows and 8 columns.
7                                       The SAS System               16:29 Tuesday, May 1, 2018

6                                       The SAS System               16:29 Tuesday, May 1, 2018
 
 
198   create table drugs as select distinct DrugName, D_COUNT, TOTAL, D_COUNT/TOTAL as
198! D_PERCENT from drug_event ;
NOTE: Table WORK.DRUGS created, with 1398 rows and 4 columns.
 
199   create table events as select distinct EventName, E_COUNT, TOTAL, E_COUNT/TOTAL as
199! E_PERCENT from drug_event ;
NOTE: Table WORK.EVENTS created, with 952 rows and 4 columns.
 
200   quit;
NOTE: PROCEDURE SQL used (Total process time):
      real time           1.39 seconds
      cpu time            2.37 seconds
 
 
201   options nosource nonotes;
WARNING: A table has been extended with null columns to perform the UNION set operation.
WARNING: A table has been extended with null columns to perform the UNION set operation.
NOTE: Remote submit to SESS3 complete.
NOTE: Remote signoff from SESS3 commencing.
NOTE: SAS Institute Inc., SAS Campus Drive, Cary, NC USA 27513-2414
NOTE: The SAS System used:
      real time           17:23:43.97
      cpu time            12:46:27.23
      
NOTE: Remote signoff from SESS3 complete.

NOTE: There were 50000 observations read from the data set WORK.EX1_1.
NOTE: The data set WORK.EX1 has 50000 observations and 3 variables.
NOTE: DATA statement used (Total process time):
      real time           0.03 seconds
      cpu time            0.01 seconds
      


NOTE: There were 163752 observations read from the data set WORK.EX2_LONG_1.
NOTE: The data set WORK.EX2_LONG has 163752 observations and 3 variables.
NOTE: DATA statement used (Total process time):
      real time           0.08 seconds
      cpu time            0.01 seconds
      


NOTE: There were 169389 observations read from the data set WORK.EX3_LONG_1.
NOTE: The data set WORK.EX3_LONG has 169389 observations and 3 variables.
NOTE: DATA statement used (Total process time):
      real time           0.10 seconds
      cpu time            0.01 seconds
      


NOTE: There were 556500 observations read from the data set WORK.EX4_LONG_1.
NOTE: The data set WORK.EX4_LONG has 556500 observations and 3 variables.
NOTE: DATA statement used (Total process time):
      real time           0.04 seconds
      cpu time            0.04 seconds
      
5                                       The SAS System               16:29 Tuesday, May 1, 2018



NOTE: There were 50000 observations read from the data set WORK.EX1_2.
NOTE: The data set WORK.EX1_2 has 50000 observations and 3 variables.
NOTE: DATA statement used (Total process time):
      real time           0.05 seconds
      cpu time            0.01 seconds
      


NOTE: There were 163680 observations read from the data set WORK.EX2_LONG_2.
NOTE: The data set WORK.EX2_LONG_2 has 163680 observations and 3 variables.
NOTE: DATA statement used (Total process time):
      real time           0.07 seconds
      cpu time            0.01 seconds
      


NOTE: There were 170023 observations read from the data set WORK.EX3_LONG_2.
NOTE: The data set WORK.EX3_LONG_2 has 170023 observations and 3 variables.
NOTE: DATA statement used (Total process time):
      real time           0.08 seconds
      cpu time            0.01 seconds
      


NOTE: There were 557374 observations read from the data set WORK.EX4_LONG_2.
NOTE: The data set WORK.EX4_LONG_2 has 557374 observations and 3 variables.
NOTE: DATA statement used (Total process time):
      real time           0.05 seconds
      cpu time            0.04 seconds
      


NOTE: Appending WORK.EX1_2 to WORK.EX1.
NOTE: There were 50000 observations read from the data set WORK.EX1_2.
NOTE: 50000 observations added.
NOTE: The data set WORK.EX1 has 100000 observations and 3 variables.
NOTE: PROCEDURE APPEND used (Total process time):
      real time           0.04 seconds
      cpu time            0.03 seconds
      


NOTE: Appending WORK.EX2_LONG_2 to WORK.EX2_LONG.
NOTE: There were 163680 observations read from the data set WORK.EX2_LONG_2.
NOTE: 163680 observations added.
NOTE: The data set WORK.EX2_LONG has 327432 observations and 3 variables.
NOTE: PROCEDURE APPEND used (Total process time):
      real time           0.00 seconds
      cpu time            0.01 seconds
6                                       The SAS System               16:29 Tuesday, May 1, 2018

      


NOTE: Appending WORK.EX3_LONG_2 to WORK.EX3_LONG.
NOTE: There were 170023 observations read from the data set WORK.EX3_LONG_2.
NOTE: 170023 observations added.
NOTE: The data set WORK.EX3_LONG has 339412 observations and 3 variables.
NOTE: PROCEDURE APPEND used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      


NOTE: Appending WORK.EX4_LONG_2 to WORK.EX4_LONG.
NOTE: There were 557374 observations read from the data set WORK.EX4_LONG_2.
NOTE: 557374 observations added.
NOTE: The data set WORK.EX4_LONG has 1113874 observations and 3 variables.
NOTE: PROCEDURE APPEND used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      


NOTE: There were 50000 observations read from the data set WORK.EX1_3.
NOTE: The data set WORK.EX1_3 has 50000 observations and 3 variables.
NOTE: DATA statement used (Total process time):
      real time           0.03 seconds
      cpu time            0.01 seconds
      


NOTE: There were 164668 observations read from the data set WORK.EX2_LONG_3.
NOTE: The data set WORK.EX2_LONG_3 has 164668 observations and 3 variables.
NOTE: DATA statement used (Total process time):
      real time           0.08 seconds
      cpu time            0.01 seconds
      


NOTE: There were 170256 observations read from the data set WORK.EX3_LONG_3.
NOTE: The data set WORK.EX3_LONG_3 has 170256 observations and 3 variables.
NOTE: DATA statement used (Total process time):
      real time           0.08 seconds
      cpu time            0.03 seconds
      


NOTE: There were 559798 observations read from the data set WORK.EX4_LONG_3.
NOTE: The data set WORK.EX4_LONG_3 has 559798 observations and 3 variables.
NOTE: DATA statement used (Total process time):
      real time           0.05 seconds
7                                       The SAS System               16:29 Tuesday, May 1, 2018

      cpu time            0.04 seconds
      


NOTE: Appending WORK.EX1_3 to WORK.EX1.
NOTE: There were 50000 observations read from the data set WORK.EX1_3.
NOTE: 50000 observations added.
NOTE: The data set WORK.EX1 has 150000 observations and 3 variables.
NOTE: PROCEDURE APPEND used (Total process time):
      real time           0.03 seconds
      cpu time            0.00 seconds
      


NOTE: Appending WORK.EX2_LONG_3 to WORK.EX2_LONG.
NOTE: There were 164668 observations read from the data set WORK.EX2_LONG_3.
NOTE: 164668 observations added.
NOTE: The data set WORK.EX2_LONG has 492100 observations and 3 variables.
NOTE: PROCEDURE APPEND used (Total process time):
      real time           0.00 seconds
      cpu time            0.01 seconds
      


NOTE: Appending WORK.EX3_LONG_3 to WORK.EX3_LONG.
NOTE: There were 170256 observations read from the data set WORK.EX3_LONG_3.
NOTE: 170256 observations added.
NOTE: The data set WORK.EX3_LONG has 509668 observations and 3 variables.
NOTE: PROCEDURE APPEND used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      


NOTE: Appending WORK.EX4_LONG_3 to WORK.EX4_LONG.
NOTE: There were 559798 observations read from the data set WORK.EX4_LONG_3.
NOTE: 559798 observations added.
NOTE: The data set WORK.EX4_LONG has 1673672 observations and 3 variables.
NOTE: PROCEDURE APPEND used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      


NOTE: There were 50000 observations read from the data set WORK.EX1_4.
NOTE: The data set WORK.EX1_4 has 50000 observations and 3 variables.
NOTE: DATA statement used (Total process time):
      real time           0.03 seconds
      cpu time            0.00 seconds
      

8                                       The SAS System               16:29 Tuesday, May 1, 2018


NOTE: There were 164742 observations read from the data set WORK.EX2_LONG_4.
NOTE: The data set WORK.EX2_LONG_4 has 164742 observations and 3 variables.
NOTE: DATA statement used (Total process time):
      real time           0.07 seconds
      cpu time            0.03 seconds
      


NOTE: There were 169743 observations read from the data set WORK.EX3_LONG_4.
NOTE: The data set WORK.EX3_LONG_4 has 169743 observations and 3 variables.
NOTE: DATA statement used (Total process time):
      real time           0.07 seconds
      cpu time            0.01 seconds
      


NOTE: There were 559579 observations read from the data set WORK.EX4_LONG_4.
NOTE: The data set WORK.EX4_LONG_4 has 559579 observations and 3 variables.
NOTE: DATA statement used (Total process time):
      real time           0.04 seconds
      cpu time            0.04 seconds
      


NOTE: Appending WORK.EX1_4 to WORK.EX1.
NOTE: There were 50000 observations read from the data set WORK.EX1_4.
NOTE: 50000 observations added.
NOTE: The data set WORK.EX1 has 200000 observations and 3 variables.
NOTE: PROCEDURE APPEND used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      


NOTE: Appending WORK.EX2_LONG_4 to WORK.EX2_LONG.
NOTE: There were 164742 observations read from the data set WORK.EX2_LONG_4.
NOTE: 164742 observations added.
NOTE: The data set WORK.EX2_LONG has 656842 observations and 3 variables.
NOTE: PROCEDURE APPEND used (Total process time):
      real time           0.00 seconds
      cpu time            0.01 seconds
      


NOTE: Appending WORK.EX3_LONG_4 to WORK.EX3_LONG.
NOTE: There were 169743 observations read from the data set WORK.EX3_LONG_4.
NOTE: 169743 observations added.
NOTE: The data set WORK.EX3_LONG has 679411 observations and 3 variables.
NOTE: PROCEDURE APPEND used (Total process time):
      real time           0.00 seconds
9                                       The SAS System               16:29 Tuesday, May 1, 2018

      cpu time            0.00 seconds
      


NOTE: Appending WORK.EX4_LONG_4 to WORK.EX4_LONG.
NOTE: There were 559579 observations read from the data set WORK.EX4_LONG_4.
NOTE: 559579 observations added.
NOTE: The data set WORK.EX4_LONG has 2233251 observations and 3 variables.
NOTE: PROCEDURE APPEND used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      


NOTE: There were 50000 observations read from the data set WORK.EX1_5.
NOTE: The data set WORK.EX1_5 has 50000 observations and 3 variables.
NOTE: DATA statement used (Total process time):
      real time           0.03 seconds
      cpu time            0.00 seconds
      


NOTE: There were 163282 observations read from the data set WORK.EX2_LONG_5.
NOTE: The data set WORK.EX2_LONG_5 has 163282 observations and 3 variables.
NOTE: DATA statement used (Total process time):
      real time           0.07 seconds
      cpu time            0.03 seconds
      


NOTE: There were 169599 observations read from the data set WORK.EX3_LONG_5.
NOTE: The data set WORK.EX3_LONG_5 has 169599 observations and 3 variables.
NOTE: DATA statement used (Total process time):
      real time           0.08 seconds
      cpu time            0.01 seconds
      


NOTE: There were 555974 observations read from the data set WORK.EX4_LONG_5.
NOTE: The data set WORK.EX4_LONG_5 has 555974 observations and 3 variables.
NOTE: DATA statement used (Total process time):
      real time           0.04 seconds
      cpu time            0.04 seconds
      


NOTE: Appending WORK.EX1_5 to WORK.EX1.
NOTE: There were 50000 observations read from the data set WORK.EX1_5.
NOTE: 50000 observations added.
NOTE: The data set WORK.EX1 has 250000 observations and 3 variables.
NOTE: PROCEDURE APPEND used (Total process time):
10                                      The SAS System               16:29 Tuesday, May 1, 2018

      real time           0.00 seconds
      cpu time            0.00 seconds
      


NOTE: Appending WORK.EX2_LONG_5 to WORK.EX2_LONG.
NOTE: There were 163282 observations read from the data set WORK.EX2_LONG_5.
NOTE: 163282 observations added.
NOTE: The data set WORK.EX2_LONG has 820124 observations and 3 variables.
NOTE: PROCEDURE APPEND used (Total process time):
      real time           0.00 seconds
      cpu time            0.01 seconds
      


NOTE: Appending WORK.EX3_LONG_5 to WORK.EX3_LONG.
NOTE: There were 169599 observations read from the data set WORK.EX3_LONG_5.
NOTE: 169599 observations added.
NOTE: The data set WORK.EX3_LONG has 849010 observations and 3 variables.
NOTE: PROCEDURE APPEND used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      


NOTE: Appending WORK.EX4_LONG_5 to WORK.EX4_LONG.
NOTE: There were 555974 observations read from the data set WORK.EX4_LONG_5.
NOTE: 555974 observations added.
NOTE: The data set WORK.EX4_LONG has 2789225 observations and 3 variables.
NOTE: PROCEDURE APPEND used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

120        
121        
122        /* create a table with 1 row per case
123        	the following has also been turned into a macro: /Macros/%cases_to_caserows
124        */
125        data EX2;
126        	length Events $500.;
127        		do until(last.Case_N);
128        			set EX2_LONG;
129        			by Case_N;
130        			Events=catx(' ',Events,EventName);
131        		end;
132        	drop EventName;
133        run;

NOTE: There were 820124 observations read from the data set WORK.EX2_LONG.
NOTE: The data set WORK.EX2 has 250000 observations and 3 variables.
11                                      The SAS System               16:29 Tuesday, May 1, 2018

NOTE: DATA statement used (Total process time):
      real time           0.21 seconds
      cpu time            0.20 seconds
      

134        data EX3;
135        	length Drugs $500.;
136        		do until(last.Case_N);
137        			set EX3_LONG;
138        			by Case_N;
139        			Drugs=catx(' ',Drugs,DrugName);
140        		end;
141        	drop DrugName;
142        run;

NOTE: There were 849010 observations read from the data set WORK.EX3_LONG.
NOTE: The data set WORK.EX3 has 250000 observations and 3 variables.
NOTE: DATA statement used (Total process time):
      real time           0.20 seconds
      cpu time            0.20 seconds
      

143        data EX4;
144        	length Drugs $500. Events $500.;
145        		do until(last.Case_N);
146        			set EX4_LONG;
147        			by Case_N;
148        			Drugs=catx(' ',Drugs,DrugName);
149        			Events=catx(' ',Events,EventName);
150        		end;
151        	drop DrugName EventName;
152        run;

NOTE: There were 2789225 observations read from the data set WORK.EX4_LONG.
NOTE: The data set WORK.EX4 has 250000 observations and 3 variables.
NOTE: DATA statement used (Total process time):
      real time           0.91 seconds
      cpu time            0.90 seconds
      

153        
154        options compress=yes;
155        
156        /* move Sample_Cases to permanent library and clean up work */
157        proc sql noprint;
158        	create table sim_out.EX1 as
159        		select * from EX1
160        	;
NOTE: Compressing data set SIM_OUT.EX1 increased size by 40.86 percent. 
      Compressed is 131 pages; un-compressed would require 93 pages.
NOTE: Table SIM_OUT.EX1 created, with 250000 rows and 3 columns.
12                                      The SAS System               16:29 Tuesday, May 1, 2018


161        	create table sim_out.EX2_LONG as
162        		select * from EX2_LONG
163        	;
NOTE: Compressing data set SIM_OUT.EX2_LONG increased size by 40.59 percent. 
      Compressed is 426 pages; un-compressed would require 303 pages.
NOTE: Table SIM_OUT.EX2_LONG created, with 820124 rows and 3 columns.

164        	create table sim_out.EX3_LONG as
165        		select * from EX3_LONG
166        	;
NOTE: Compressing data set SIM_OUT.EX3_LONG increased size by 40.89 percent. 
      Compressed is 441 pages; un-compressed would require 313 pages.
NOTE: Table SIM_OUT.EX3_LONG created, with 849010 rows and 3 columns.

167        	create table sim_out.EX2 as select Case_N, DrugName, Events from EX2;
NOTE: Compressing data set SIM_OUT.EX2 decreased size by 89.21 percent. 
      Compressed is 216 pages; un-compressed would require 2001 pages.
NOTE: Table SIM_OUT.EX2 created, with 250000 rows and 3 columns.

168        	create table sim_out.EX3 as select Case_N, Drugs, EventName from EX3;
NOTE: Compressing data set SIM_OUT.EX3 decreased size by 89.26 percent. 
      Compressed is 215 pages; un-compressed would require 2001 pages.
NOTE: Table SIM_OUT.EX3 created, with 250000 rows and 3 columns.

169        	create table sim_out.EX4 as select Case_N, Drugs, Events from EX4;
NOTE: Compressing data set SIM_OUT.EX4 decreased size by 79.11 percent. 
      Compressed is 816 pages; un-compressed would require 3907 pages.
NOTE: Table SIM_OUT.EX4 created, with 250000 rows and 3 columns.

170        	drop table EX1, EX2, EX3, EX2_LONG, EX3_LONG, EX4, EX4_LONG;
NOTE: Table WORK.EX1 has been dropped.
NOTE: Table WORK.EX2 has been dropped.
NOTE: Table WORK.EX3 has been dropped.
NOTE: Table WORK.EX2_LONG has been dropped.
NOTE: Table WORK.EX3_LONG has been dropped.
NOTE: Table WORK.EX4 has been dropped.
NOTE: Table WORK.EX4_LONG has been dropped.
171        quit;
NOTE: PROCEDURE SQL used (Total process time):
      real time           1.67 seconds
      cpu time            1.67 seconds
      

NOTE: SAS Institute Inc., SAS Campus Drive, Cary, NC USA 27513-2414
NOTE: The SAS System used:
      real time           17:23:50.04
      cpu time            4.62 seconds
      
